require '../tools/readJSON'
require '../tools/csv2json'
require '../tools/excel2csv'
require 'csv'
require 'json'
require 'time'
require "json-diff"
require "hashdiff"
require 'yomu'

curren_dir = File.dirname(__FILE__)

puts "current directory: #{curren_dir}"

@converted_json_dir = "#{curren_dir}/../converted_json/"

@dt4_formula_json = "dt4_seed_data_formula.json"

#05
def insert_study_milestone(seedTrialID)
     @seed_json_data = read_json_from_dir(@converted_json_dir, @dt4_formula_json)
     @seed_data = @seed_json_data.find {|x| x['seedTrialID'] == "#{seedTrialID}"}
     puts @seed_data
sql_insert_study_milestone =
    "
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+0}',NULL,'SUBMISSION_RECEIVED','2018-02-21 08:34:56.597','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 08:34:56.81','2018-02-21 08:34:56.81','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+1}',NULL,'SUBMISSION_ACCEPTED','2018-02-21 13:37:24.422969','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:37:24.422969','2018-02-21 13:37:24.422969','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+2}',NULL,'ADMINISTRATIVE_PROCESSING_START_DATE','2018-02-21 13:37:24.422969','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:37:24.422969','2018-02-21 13:37:24.422969','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+3}',NULL,'ADMINISTRATIVE_PROCESSING_COMPLETED_DATE','2018-02-21 13:37:24.422969','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:37:24.422969','2018-02-21 13:37:24.422969','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+4}',NULL,'ADMINISTRATIVE_READY_FOR_QC','2018-02-21 13:37:24.422969','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:37:24.422969','2018-02-21 13:37:24.422969','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+5}',NULL,'ADMINISTRATIVE_QC_START','2018-02-21 13:37:24.422969','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:37:24.422969','2018-02-21 13:37:24.422969','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+6}',NULL,'ADMINISTRATIVE_QC_COMPLETE','2018-02-21 13:37:24.422969','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:37:24.422969','2018-02-21 13:37:24.422969','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+7}',NULL,'SCIENTIFIC_PROCESSING_START_DATE','2018-02-21 13:37:24.422969','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:37:24.422969','2018-02-21 13:37:24.422969','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+8}',NULL,'SCIENTIFIC_PROCESSING_COMPLETED_DATE','2018-02-21 13:37:24.422969','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:37:24.422969','2018-02-21 13:37:24.422969','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+9}',NULL,'SCIENTIFIC_READY_FOR_QC','2018-02-21 13:37:24.422969','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:37:24.422969','2018-02-21 13:37:24.422969','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+10}',NULL,'SCIENTIFIC_QC_START','2018-02-21 13:37:24.422969','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:37:24.422969','2018-02-21 13:37:24.422969','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+11}',NULL,'SCIENTIFIC_QC_COMPLETE','2018-02-21 13:37:24.422969','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:37:24.422969','2018-02-21 13:37:24.422969','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+12}',NULL,'READY_FOR_TSR','2018-02-21 13:37:24.422969','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:37:24.422969','2018-02-21 13:37:24.422969','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+13}',NULL,'TRIAL_SUMMARY_REPORT','2018-02-21 13:37:24.422969','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:37:24.422969','2018-02-21 13:37:24.422969','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+14}',NULL,'TRIAL_SUMMARY_FEEDBACK','2018-02-21 13:37:24.422969','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:37:24.422969','2018-02-21 13:37:24.422969','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+15}',NULL,'INITIAL_ABSTRACTION_VERIFY','2018-02-21 13:37:24.422969','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:37:24.422969','2018-02-21 13:37:24.422969','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+16}',NULL,'ONGOING_ABSTRACTION_VERIFICATION','2018-02-21 13:37:24.422969','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:37:24.422969','2018-02-21 13:37:24.422969','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+17}',NULL,'SUBMISSION_ACCEPTED','2018-02-21 13:37:38.536856','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:37:38.536856','2018-02-21 13:37:38.536856','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+18}',NULL,'ADMINISTRATIVE_PROCESSING_START_DATE','2018-02-21 13:38:55.674961','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:38:55.674961','2018-02-21 13:38:55.674961','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+19}',NULL,'ADMINISTRATIVE_PROCESSING_COMPLETED_DATE','2018-02-21 13:38:59.716404','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:38:59.716404','2018-02-21 13:38:59.716404','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+20}',NULL,'ADMINISTRATIVE_READY_FOR_QC','2018-02-21 13:39:02.938099','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:39:02.938099','2018-02-21 13:39:02.938099','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+21}',NULL,'ADMINISTRATIVE_QC_START','2018-02-21 13:39:06.937205','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:39:06.937205','2018-02-21 13:39:06.937205','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+22}',NULL,'ADMINISTRATIVE_QC_COMPLETE','2018-02-21 13:39:09.623154','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:39:09.623154','2018-02-21 13:39:09.623154','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+23}',NULL,'SCIENTIFIC_PROCESSING_START_DATE','2018-02-21 13:39:13.095197','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:39:13.095197','2018-02-21 13:39:13.095197','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+24}',NULL,'SCIENTIFIC_PROCESSING_COMPLETED_DATE','2018-02-21 13:39:15.935163','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:39:15.935163','2018-02-21 13:39:15.935163','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+25}',NULL,'SCIENTIFIC_READY_FOR_QC','2018-02-21 13:39:20.769074','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:39:20.769074','2018-02-21 13:39:20.769074','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+26}',NULL,'SCIENTIFIC_QC_START','2018-02-21 13:39:24.896474','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:39:24.896474','2018-02-21 13:39:24.896474','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+27}',NULL,'SCIENTIFIC_QC_COMPLETE','2018-02-21 13:39:27.829469','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:39:27.829469','2018-02-21 13:39:27.829469','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+28}',NULL,'READY_FOR_TSR','2018-02-21 13:39:32.250555','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:39:32.250555','2018-02-21 13:39:32.250555','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+29}',NULL,'TRIAL_SUMMARY_REPORT','2018-02-21 13:39:38.835382','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:39:38.835382','2018-02-21 13:39:38.835382','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+30}',NULL,'TRIAL_SUMMARY_FEEDBACK','2018-02-21 13:39:45.275444','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:39:45.275444','2018-02-21 13:39:45.275444','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+31}',NULL,'INITIAL_ABSTRACTION_VERIFY','2018-02-21 13:39:48.503572','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:39:48.503572','2018-02-21 13:39:48.503572','14','14',NULL,'f','f','f','f','f');
     INSERT INTO study_milestone (identifier,comment_text,milestone_code,milestone_date,study_protocol_identifier,date_last_created,date_last_updated,user_last_created_id,user_last_updated_id,rejection_reason_code,active,admin,last,other,scientific) VALUES ('#{@seed_data['study_milestone_identifier'].gsub("'", "").to_i+32}',NULL,'ONGOING_ABSTRACTION_VERIFICATION','2018-02-21 13:39:55.73705','#{@seed_data['study_milestone_study_protocol_identifier'].gsub("'", "")}','2018-02-21 13:39:55.73705','2018-02-21 13:39:55.73705','14','14',NULL,'t','f','t','t','f');
    "
     puts sql_insert_study_milestone
end

#insert_study_milestone 'ST20182602A'

